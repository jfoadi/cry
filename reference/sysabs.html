<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Locate systematic absences — sysabs • cry</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Locate systematic absences — sysabs"><meta name="description" content="Given an mX3 matrix of Miller indices, this function returns
those indices corresponding to valid reflections, i.e. to
reflections which are not systematic absences."><meta property="og:description" content="Given an mX3 matrix of Miller indices, this function returns
those indices corresponding to valid reflections, i.e. to
reflections which are not systematic absences."><meta property="og:image" content="https://jfoadi.github.io/cry/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cry</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/MTZ.html">Read and analyse an MTZ file</a></li>
    <li><a class="dropdown-item" href="../articles/SHELX.html">Read SHELXC/D/E log file</a></li>
    <li><a class="dropdown-item" href="../articles/XDS.html">Read and analyse an XDS file</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Locate systematic absences</h1>

      <div class="d-none name"><code>sysabs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given an mX3 matrix of Miller indices, this function returns
those indices corresponding to valid reflections, i.e. to
reflections which are not systematic absences.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sysabs</span><span class="op">(</span><span class="va">hkl</span>, <span class="va">SG</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-hkl">hkl<a class="anchor" aria-label="anchor" href="#arg-hkl"></a></dt>
<dd><p>An mX3 matrix or a data frame whose rows are the
three integers corresponding to the Miller
indices.</p></dd>


<dt id="arg-sg">SG<a class="anchor" aria-label="anchor" href="#arg-sg"></a></dt>
<dd><p>A character. The extended Hermann-Mauguin symbol
of the crystallographic space group.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>idx A vector of integers corresponding to the
            position, in the array <code>mhkl</code>, in which the
            Miller indices ARE NOT systematically absent.
            The position of systematically-absent reflections
            can be found using !idx.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Crystallography symmetry forces constraints on data from
x-ray diffraction. One of these constraints consists in the
full cancellation of reflections with certain Miller indices.
It is said that the reflection with that specific Miller index
is systematically absent. For example, in data corresponding
to a crystal with space group C 2, general reflections like
(h,k,l) must obey h+k=2n (even number). Thus, the Miller
indices (2,3,1) are a systematic absence because 2+3=5 (odd).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># C 2 monoclinic space group (special setting)</span></span></span>
<span class="r-in"><span><span class="va">csym</span> <span class="op">&lt;-</span> <span class="fu"><a href="cryst_symm.html">cryst_symm</a></span><span class="op">(</span><span class="fl">15</span>,set<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">csym</span><span class="op">$</span><span class="va">SG</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "C 1 2/n 1"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a full data frame of Miller indices</span></span></span>
<span class="r-in"><span><span class="va">hkl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>H<span class="op">=</span><span class="op">-</span><span class="fl">4</span><span class="op">:</span><span class="fl">4</span>,K<span class="op">=</span><span class="op">-</span><span class="fl">4</span><span class="op">:</span><span class="fl">4</span>,L<span class="op">=</span><span class="op">-</span><span class="fl">4</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Index corresponding to valid reflections</span></span></span>
<span class="r-in"><span><span class="co"># (not systematic absences)</span></span></span>
<span class="r-in"><span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu">sysabs</span><span class="op">(</span><span class="va">hkl</span>,<span class="va">csym</span><span class="op">$</span><span class="va">SG</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Indices for all reflections</span></span></span>
<span class="r-in"><span><span class="va">fulldx</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">hkl</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Index corresponding to systematic absences</span></span></span>
<span class="r-in"><span><span class="va">jdx</span> <span class="op">&lt;-</span> <span class="va">fulldx</span><span class="op">[</span><span class="op">-</span><span class="va">idx</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A couple of systematic absences</span></span></span>
<span class="r-in"><span><span class="va">hkl</span><span class="op">[</span><span class="va">jdx</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    H  K  L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -3 -4 -4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -1 -4 -4</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Foadi, David Waterman, Rita Giordano, Kutumbarao Nidamarthi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

