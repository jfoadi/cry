<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Statistics for Structural Crystallography • cry</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Statistics for Structural Crystallography">
<meta name="description" content="Reading and writing of files in the most commonly used formats of structural crystallography. It includes functions to work with a variety of statistics used in this field and functions to perform basic crystallographic computing. References: D. G. Waterman, J. Foadi, G. Evans (2011) &lt;doi:10.1107/S0108767311084303&gt;.">
<meta property="og:description" content="Reading and writing of files in the most commonly used formats of structural crystallography. It includes functions to work with a variety of statistics used in this field and functions to perform basic crystallographic computing. References: D. G. Waterman, J. Foadi, G. Evans (2011) &lt;doi:10.1107/S0108767311084303&gt;.">
<meta property="og:image" content="https://jfoadi.github.io/cry/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">cry</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/MTZ.html">Read and analyse an MTZ file</a></li>
    <li><a class="dropdown-item" href="articles/SHELX.html">Read SHELXC/D/E log file</a></li>
    <li><a class="dropdown-item" href="articles/XDS.html">Read and analyse an XDS file</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="cry-">cry <a class="anchor" aria-label="anchor" href="#cry-"></a>
</h1>
</div>
<!-- badges: start -->

<!-- badges: end -->
<p><em>cry</em> is an R package to make it easier dealing with crystallographic data. The package includes functions to read/write data from/to some of the file mostly used in software for structural crystallography. Current entry include the <code>readMTZ</code> function to read MTZ files (see <a href="https://www.ccp4.ac.uk" class="external-link">CCP4</a>) and the corresponding <code>writeMTZ</code>. There are also <code>readCIF</code>, <code>readpd_rtv</code> and <code>readSF_CIF</code> to read files in CIF formats (Crystallographic Information Framework, see <a href="https://www.iucr.org/resources/cif" class="external-link">IUCr page</a>). Users are welcome to suggest inclusions of different (not currently available) formats they might need for specific tasks and/or analysis.</p>
<p><em>cry</em> includes also several functions to perform the most common and routine crystallographic calculations, many of them involving crystallographic symmetry. The main purpose of these functions is to enable users to investigate specific issues without having to resort to external packages and thus carrying the analysis through without having to abandon the R platform.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of crone from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"cry"</span><span class="op">)</span></span></code></pre></div>
<p>And the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"jfoadi/cry"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a simple example in which a CIF file containing structure factors is read and a part of its data used for statistical analysis. The file is included as example file in <em>cry</em> and is called <em>1dei-sf.cif</em>. The first task is to import the data in R.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load cry package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jfoadi.github.io/cry/">cry</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save CIF data in a named list</span></span>
<span><span class="va">datadir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,package<span class="op">=</span><span class="st">"cry"</span><span class="op">)</span></span>
<span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">datadir</span>,<span class="st">"1dei-sf.cif"</span><span class="op">)</span></span>
<span><span class="va">lCIF</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/readSF_CIF.html">readSF_CIF</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span></code></pre></div>
<p>The newly-created R object, a list called <code>lCIF</code>, contains all that is included in the CIF file, but within a structure that can be used within R for various analyses. The components of this list can be readily explored using the common R functions <code>names</code>, <code>class</code> and <code>str</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># What's containe in lCIF?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lCIF</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "HEADER" "SYMM"   "REFL"</span></span>
<span></span>
<span><span class="co"># What's the header?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">)</span>   <span class="co"># It's a list</span></span>
<span><span class="co">#&gt; [1] "list"</span></span>
<span></span>
<span><span class="co"># Is it a named list?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">)</span>  <span class="co"># Yes</span></span>
<span><span class="co">#&gt; [1] "TITLE"      "CELL"       "SGN"        "HALL"       "HM"        </span></span>
<span><span class="co">#&gt; [6] "SHELX_CODE" "F_000"      "HIGH_RES"</span></span>
<span></span>
<span><span class="co"># What's the space group name for this crystal structure?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">HM</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span></span>
<span><span class="co"># What's the space group number corresponding to P 21 21 21?</span></span>
<span><span class="co"># Use one of cry's functions</span></span>
<span><span class="va">xHM</span> <span class="op">&lt;-</span> <span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">HM</span></span>
<span><span class="fu"><a href="reference/translate_SG.html">translate_SG</a></span><span class="op">(</span><span class="va">xHM</span>,SG_in<span class="op">=</span><span class="st">"xHM"</span>,SG_out<span class="op">=</span><span class="st">"number"</span><span class="op">)</span><span class="op">$</span><span class="va">msg</span></span>
<span><span class="co">#&gt; [1] "Something wrong in your input:\n   1) the symbol or number input for this space group does not exist\n   2) if your inpur was a number, perhaps for this space group there are not that many settings"</span></span>
<span></span>
<span><span class="co"># ... and the unit cell parameters?</span></span>
<span><span class="va">cpars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">CELL</span><span class="op">$</span><span class="va">A</span><span class="op">$</span><span class="va">VAL</span>,<span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">CELL</span><span class="op">$</span><span class="va">B</span><span class="op">$</span><span class="va">VAL</span>,</span>
<span>           <span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">CELL</span><span class="op">$</span><span class="va">C</span><span class="op">$</span><span class="va">VAL</span>,<span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">CELL</span><span class="op">$</span><span class="va">ALPHA</span><span class="op">$</span><span class="va">VAL</span>,</span>
<span>           <span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">CELL</span><span class="op">$</span><span class="va">BETA</span><span class="op">$</span><span class="va">VAL</span>,<span class="va">lCIF</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">CELL</span><span class="op">$</span><span class="va">GAMMA</span><span class="op">$</span><span class="va">VAL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cpars</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA NA NA NA NA NA</span></span>
<span></span>
<span><span class="co"># The unit cell belongs to the orthorombic system,</span></span>
<span><span class="co"># as it should be, due to symmetry (cry function)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="reference/crystal_system.html">crystal_system</a></span><span class="op">(</span>gn<span class="op">=</span><span class="fl">19</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ORTHOROMBIC"</span></span></code></pre></div>
<p>The most important bit in the CIF file are the observed reflections (coming from x-ray diffraction of one or more crystals). They are contained in the named list <code>REFL</code>. All CIF files have a <code>VAL</code> field reporting the specific observed quantity and a field <code>STD</code> reporting the corresponding experimental error. Not always the last one is available. The <code>VAL</code> field is an R data frame that makes these data suitable to further analysis within R. The <code>STD</code> field mirrors <code>VAL</code>, but with the experimental errors counterparts, if available, otherwise it is <code>NULL</code>, as in the case here reported.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=cry" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cry</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>James Foadi <br><small class="roles"> Author, maintainer </small>   </li>
<li>David Waterman <br><small class="roles"> Author </small>   </li>
<li>Rita Giordano <br><small class="roles"> Author </small>   </li>
<li>Kutumbarao Nidamarthi <br><small class="roles"> Author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/jfoadi/cry/actions" class="external-link"><img src="https://github.com/jfoadi/cry/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=cry" class="external-link"><img src="https://www.r-pkg.org/badges/version/cry" alt="CRAN status"></a></li>
<li><a href="https://github.com/jfoadi/cry/actions" class="external-link"><img src="https://github.com/jfoadi/cry/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Foadi, David Waterman, Rita Giordano, Kutumbarao Nidamarthi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
